<!DOCTYPE html>
<!--
 Copyright 2015 Google LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->

<html>
	<head>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script>

		<script src='myo.js'></script>
		<script src='flex.myo.js'></script>
		<script src='../snap.myo.js'></script>

		<link href="diagnosticsStyle/base.css" rel="stylesheet">
		<link rel="icon" href="diagnosticsStyle/img/favicon.ico" type="image/x-icon" />
		<script src='diagnosticsStyle/graph.js'></script>

		<style>
			.flex_it{
				width : 100px;
				vertical-align: middle;
				display: inline-block;
				margin-right: 50px;
				opacity : 0.3;
			}
			.flex_it > *{
				width : 100%;
			}
			.show{
				opacity : 1;
			}
			.text{
				text-align: center;
				display: inline-block;
				vertical-align: middle;

				visibility: hidden;
			}
			.show .text{
				visibility: visible;
			}
			svg path{
				stroke : #58bccc;
				stroke-width : 3px;
				fill : transparent;
			}
			.graph{
				display:inline-block;
				vertical-align: middle;
			}
			.snap svg{
				width : 300px;
				opacity : 0.3;
				vertical-align: middle;
			}
			.snap.show svg{
				opacity : 1;
			}
			.snap .text{
				font-size: 3em;
			}
		</style>
	</head>
	<body>
		<title>Snap Demo - Myo.js</title>
		<h1>
			Snap Demo for Myo.js
			<a href='https://github.com/thalmiclabs/myojs-snap'><small>Project here</small></a>
		</h1>
		<p>
			snap.myo.js emits a snap event whenever the user snaps. It looks for specific 'blips' in the IMU data when the fingers vibrate the arm. The library uses flex.myo.js to make sure it only triggers by the arm flexing, removes a lot of false positives.
		</p>

		<div class='snap'>
			<svg class='snap' xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" enable-background="new 0 0 100 100" xml:space="preserve"><g><path fill="#000000" stroke="#FFFFFF" stroke-width="4.599" d="M69.111,80.425"/></g><g><path fill="#000000" d="M82.893,29.628c-3.038-1.831-6.985-0.854-8.818,2.184l-3.543,5.877l-0.008-0.072   c0,0-0.081,0.179-0.231,0.468l-0.907,1.506c-1.121,1.632-3.027,3.696-5.549,3.774c-2.791,0.088-5.593-2.123-6.751-3.16   L33.01,17.409c-2.131-2.018-5.494-1.925-7.511,0.204c-2.018,2.132-1.926,5.493,0.205,7.511L48.11,46.34l-0.065,0.032l8.408,7.961   c1.476,1.397,2.319,3.287,2.375,5.318c0.056,2.033-0.685,3.967-2.082,5.442c-1.43,1.511-3.445,2.378-5.527,2.378   c-0.542,0-1.076-0.059-1.596-0.17c0.157,0.58,0.246,1.179,0.263,1.793c0.056,2.033-0.684,3.967-2.082,5.442   c-1.431,1.511-3.446,2.378-5.528,2.378c-0.543,0-1.079-0.059-1.599-0.171c0.671,2.479,0.076,5.24-1.815,7.236   c-0.969,1.022-2.205,1.75-3.549,2.113l0.035,0.073c3.502,7.316,12.272,10.41,19.59,6.908l15.557-7.445   c7.318-3.501,10.411-12.271,6.91-19.59l-3.968-8.29l11.64-19.304C86.908,35.408,85.93,31.46,82.893,29.628z"/></g><g><path fill="#000000" d="M70.138,23.229c-0.945,0.691-2.271,0.485-2.961-0.46l0,0c-0.691-0.944-0.485-2.27,0.458-2.96l6.413-4.691   c0.944-0.691,2.27-0.485,2.961,0.459l0,0c0.691,0.944,0.485,2.27-0.46,2.961L70.138,23.229z"/></g><g><path fill="#000000" d="M65.312,17.413c-0.472,1.072-1.723,1.556-2.792,1.083l0,0c-1.071-0.473-1.557-1.723-1.083-2.793   l3.208-7.268c0.473-1.071,1.724-1.557,2.794-1.084l0,0c1.07,0.473,1.556,1.723,1.083,2.794L65.312,17.413z"/></g><g><path fill="#000000" d="M58.229,14.789c0.125,1.164-0.716,2.208-1.879,2.334l0,0c-1.162,0.126-2.208-0.715-2.334-1.878L53.16,7.346   c-0.125-1.164,0.716-2.208,1.878-2.333l0,0c1.164-0.127,2.209,0.714,2.336,1.876L58.229,14.789z"/></g><g><path fill="#000000" d="M50.782,16.059c0.69,0.944,0.485,2.27-0.459,2.959l0,0c-0.944,0.691-2.27,0.486-2.961-0.458l-4.69-6.413   c-0.691-0.944-0.485-2.27,0.459-2.961l0,0c0.944-0.691,2.27-0.485,2.96,0.459L50.782,16.059z"/></g><g><path fill="#000000" d="M45.93,65.446c2.13,2.017,2.222,5.379,0.205,7.511l0,0c-2.017,2.129-5.38,2.221-7.51,0.203L23.009,58.438   c-2.13-2.019-2.223-5.382-0.205-7.513l0,0c2.017-2.13,5.379-2.222,7.51-0.204L45.93,65.446z"/></g><g><path fill="#000000" d="M54.872,56.003c2.13,2.017,2.222,5.38,0.204,7.511l0,0c-2.017,2.129-5.38,2.22-7.511,0.203l-15.54-14.715   c-2.131-2.018-2.223-5.381-0.206-7.51l0,0c2.018-2.132,5.38-2.223,7.511-0.206L54.872,56.003z"/></g><g><path fill="#000000" d="M36.988,74.889c2.13,2.018,2.221,5.381,0.204,7.512l0,0c-2.017,2.129-5.38,2.221-7.511,0.203L16.426,70.051   c-2.13-2.016-2.223-5.38-0.205-7.51l0,0c2.018-2.13,5.38-2.222,7.51-0.204L36.988,74.889z"/></g></svg>

			<div class='snap_text text'>Snap!</div>
		</div>

		<div>
			<div class="flex_it">
				<img src='diagnosticsStyle/img/muscle_croissant2.png' />
				<div class='text'>Flexed!</div>
			</div>
			<div class='emgGraph graph'></div>

			<p>
				When you snap, the graph has to go over the threshold to get registered as a snap. You can modify this threshold to find a value that works for you.
			</p>
		</div>
	</body>

	<script>
		Myo.connect();

		Myo.plugins.flex.threshold = 0.3;

		var emgGraph = createGraph({
			resolution : 200,
			element : '.emgGraph',
			initialData : {strength : 0, threshold : Myo.plugins.flex.threshold},
			range : [0, 1]
		});

		Myo.on('flex_strength', function(val){
			emgGraph.add({
				strength : val,
				threshold : Myo.plugins.flex.threshold
			});

			if(val > Myo.plugins.flex.threshold){
				$('.flex_it').addClass('show');
			}else{
				$('.flex_it').removeClass('show');
			}
		});

		Myo.on('snap', function(){
			$('.snap').addClass('show');
			setTimeout(function(){
				$('.snap').removeClass('show');
			}, 300)
		})
	</script>
</html>
